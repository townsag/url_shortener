todo:
- generate unique short urls
    - how do we garuantee that concurrently generated short urls are unique:
        - pre generate short url codes
        - partition the namespace of short url codes by the number of servers
        - use insert into on conflict to prevent concurrent updates
            - this is the simplest solution, use this with random generation
- store mapping between short urls and long urls
- serve short url redirects quickly
- analytics:
    - how many times has that short url been clicked
    - how many times has that long url been clicked across short urls

- when making the dockerfile for url shortener, do I have to copy in the url_shortener
  directory name for it to build properly?

- context:
    - a way to pass request scoped variables accross api boundaries and between processes
    - can be used to store lifetime information about a task / request
    - https://go.dev/blog/context



- Next steps:
    - [x] understand what context is?
    - [x] add the database client to the application, pass it to the handlers
    - [x] add two routes:
        - GET /{short_url_id}
        - POST /register
    - [x] add database support to those two routes
    - [x] add health check
    - [x] add docker compose configuration
    - [x] add frontend
        - [x] add basic skeleton framework ui directory
            - understand sveltekit project structure
            - understand how to embed spa / static site files in my golang application
            - (handle refresh case: https://bindplane.com/blog/embed-react-in-golang)
        - [x] add functionality
            - make short urls
        - [x] add basic styling
    - [x] add caching
    - [ ] add metrics
        - [x] record metrics with prometheus
        - migrate to using otel for metrics instead of native prometheus
        - push or pull method?
        - deeper understand labels / tags of metrics (request type or path)
        - write some simple queries
            - https://medium.com/observability-101/5-essential-prometheus-metrics-every-developer-should-monitor-c201ed920037
        - [ ] visualize metrics with grafana
    - [ ] add tracing
        - opentelemetry + Grafana Tempo
        - minimal docker compose example:
            - https://github.com/grafana/tempo/tree/main/example/docker-compose/otel-collector
        - emphasize the integration between grafana for metrics and grafana tempo
            - [ ] use exemplars to correlate traces and metrics
    - [ ] add log aggregation
        - slog + Grafana Loki
    - [ ] add admin dashboard
    - [ ] add horizontal scaling
    - [ ] add load balancing
    - [ ] add log aggregation
        - analytics?
    - [ ] add auth?
    - testing types
        - unit + integration tests with code coverage
        - formal specification
            - tla+ or P
        - property testing
            - testing/quick
            - https://pkg.go.dev/testing/quick
        - code coverage guided property based testing
            - not yet implemented in golang

## Resources:
- net/http and the structure of golang webserver applications
    - https://www.alexedwards.net/blog/an-introduction-to-handlers-and-servemuxes-in-go
    - https://www.alexedwards.net/blog/the-fat-service-pattern
        - TODO: refactor to handler - service - repository pattern because fat-service makes for verbose test that do not follow separation of concerns principle 
- context package conceptual
    - https://go.dev/blog/context
- url shortener system design
    - https://www.youtube.com/watch?v=xFeWVugaouk
- back of the napkin estimation
    - https://static.googleusercontent.com/media/sre.google/en//static/pdf/rule-of-thumb-latency-numbers-letter.pdf
- go programming patterns
    - https://go.dev/doc/effective_go
    - TODO: read more
- json wrangling
    - https://www.alexedwards.net/blog/how-to-properly-parse-a-json-request-body
- testing postgres applications
    - https://testcontainers.com/guides/getting-started-with-testcontainers-for-go/#_getting_started
    - https://golang.testcontainers.org/modules/postgres/
- structured logging:
    - https://go.dev/blog/slog